{"title":"t-SNE and UMAP","markdown":{"yaml":{"title":"t-SNE and UMAP","format":{"html":{"toc":true,"toc-location":"right","number-sections":true,"code-fold":false,"sidebar":true}},"editor":"visual","editor_options":{"chunk_output_type":"console"},"knitr":{"opts_chunk":{"message":false,"warning":false,"code-fold":false,"include":true,"collapse":true,"eval":true,"fig.show":"hold"}}},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n\nIn this tutorial, we explore two popular nonlinear methods: **t-SNE** (t-distributed Stochastic Neighbor Embedding) and **UMAP** (Uniform Manifold Approximation and Projection).\n\n## t-SNE\n\n**t-SNE** works by computing pairwise similarities between points in high-dimensional space, then finding a low-dimensional embedding that preserves those similarities. It minimizes the divergence between probability distributions using gradient descent. It is particularly good at keeping similar points close together.\n\n**Steps in t-SNE**\n\n1.  Compute pairwise distances between all data points in high-dimensional space.\n2.  Convert distances to conditional probabilities representing similarities.\n3.  Initialize points randomly in 2D or 3D space.\n4.  Compute low-dimensional similarities using a t-distribution.\n5.  Minimize the Kullback-Leibler divergence between the two distributions using gradient descent.\n6.  Update points iteratively to reduce divergence.\n\n## UMAP\n\nUMAP constructs a high-dimensional graph representing the data and then optimizes a low-dimensional projection that preserves both local neighborhoods and some global relationships. It is built on manifold learning and is generally faster than t-SNE, scaling better to large datasets.\n\n**Steps in UMAP**\n\n1.  Compute k-nearest neighbors for each data point.\n2.  Estimate the probability graph based on local distances.\n3.  Construct a fuzzy topological representation of the data.\n4.  Initialize low-dimensional embedding randomly.\n5.  Optimize layout to preserve high-dimensional graph structure in low dimensions using stochastic gradient descent.\n\n## Data\n\n```{r}\nlibrary(tidyverse)\nlibrary(mixOmics)\ndata(breast.TCGA)\n\n# Combine training and test sets\nx <- rbind(breast.TCGA$data.train$mirna, breast.TCGA$data.test$mirna)\nlabels <- factor(c(breast.TCGA$data.train$subtype, breast.TCGA$data.test$subtype))\n\n# Scale the data\nx_scaled <- scale(x)\n```\n\n```{r}\n#| label: load-data\n\nlibrary(mixOmics)\ndata(breast.TCGA)\n\nx <- rbind(breast.TCGA$data.train$mirna,breast.TCGA$data.test$mirna)\ngroup_labels <-c(breast.TCGA$data.train$subtype,breast.TCGA$data.test$subtype)\n\n```\n\n```{r}\n#| label: fig-data-preview\n#| fig.cap: \"Preview of the miRNA data matrix\"\n#| fig.width: 12\n#| fig.height: 10\n\n# data dimensions\nx |> dim() |> print () # dimensions of the data matrix (samples x features)\ngroup_labels |> as.factor() |> summary() # samples per group\n\n# box plots \npar(mfrow=c(2,1))\nboxplot(t(x), main=\"distribution per sample\", las=2, cex.axis=0.7, col=rainbow(10), outline=FALSE, cex.main=0.8)\nboxplot(x, main=\"distribution per miRNA\", las=2, cex.axis=0.7, col=rainbow(10), outline=FALSE, cex.main=0.8)\n\n```\n\n```{r}\n#| label: pca\n#| fig.keep: all\n\n# perform PCA\npca <- prcomp(x, center=TRUE, scale.=FALSE)\neigs <- pca$sdev^2\nvar_exp <- eigs / sum(eigs)\n\nres_pca <- data.frame(PC1=pca$x[,1], PC2=pca$x[,2], PC3=pca$x[,3], PC4=pca$x[,4], PC5=pca$x[,5]) |>\n    rownames_to_column(\"sample\") |> \n    as_tibble() \n\nres_pca_loadings <- pca$rotation\n\n# show PCA scores plots\np_pca <- res_pca |>\n    ggplot(aes(x=PC1, y=PC2, color=group_labels)) +\n    geom_point() +\n    labs(title=\"PCA of miRNA data\", x=\"PC1\", y=\"PC2\") +\n    xlab(paste(\"PC1 (Var: \", round(var_exp[1] * 100, 2), \"%)\")) +\n    ylab(paste(\"PC2 (Var: \", round(var_exp[2] * 100, 2), \"%)\")) +\n    theme_minimal() +\n    scale_color_manual(values=c(\"Basal\"=\"#FF0000\", \"Her2\"=\"#00FF00\", \"LumA\"=\"#0000FF\")) +\n    theme(legend.title=element_blank())\n\n# show top 10 loadings along PC1\nres_pca_loadings |> \n    as.data.frame() |> \n    rownames_to_column(\"miRNA\") |> \n    arrange(desc(abs(PC1))) |> \n    head(10) |> \n    ggplot(aes(x=reorder(miRNA, PC1), y=PC1)) +\n    geom_bar(stat=\"identity\", fill=\"steelblue\") +\n    coord_flip() +\n    labs(title=\"Top 10 miRNAs contributing to PC1\", x=\"miRNA\", y=\"Loading\") +\n    theme_minimal()\n\n```\n\n## Run t-SNE\n\n```{r}\nlibrary(Rtsne)\n\nx_scaled <- scale(x) # scale data\n\nset.seed(42)\ntsne_out <- Rtsne(x_scaled, dims = 2, perplexity = 30, verbose = TRUE)\n\n# Key parameters\n# - perplexity: Balances local/global structure (recommended: 5–50)\n# - dims: Output dimensions (2D or 3D)\n# - theta: Speed/accuracy tradeoff\n# - max_iter: Iteration count\n\ntsne_df <- data.frame(\n  X = tsne_out$Y[, 1],\n  Y = tsne_out$Y[, 2],\n  Subtype = labels\n)\n\np_tsne <- ggplot(tsne_df, aes(x = X, y = Y, color = Subtype)) +\n  geom_point(size = 2) +\n  theme_minimal() +\n  labs(title = \"t-SNE on miRNA data\") + \n  scale_color_manual(values = c(\"Basal\" = \"#FF0000\", \"Her2\" = \"#00FF00\", \"LumA\" = \"#0000FF\"))\n\nplot(p_tsne)\n\n```\n\n## Run UMAP\n\n```{r}\nlibrary(umap)\n\nset.seed(42)\numap_out <- umap(x_scaled)\n\n# Key parameters\n# - n_neighbors: Higher = more global structure\n# - min_dist: Smaller = tighter clusters\n# - metric: Distance measure (e.g., \"euclidean\")\n\numap_df <- data.frame(\n  X = umap_out$layout[, 1],\n  Y = umap_out$layout[, 2],\n  Subtype = labels\n)\n\np_umap <- ggplot(umap_df, aes(x = X, y = Y, color = Subtype)) +\n  geom_point(size = 2) +\n  theme_minimal() +\n  labs(title = \"UMAP on miRNA data\") + \n  scale_color_manual(values = c(\"Basal\" = \"#FF0000\", \"Her2\" = \"#00FF00\", \"LumA\" = \"#0000FF\"))\n\nplot(p_umap)\n```\n\n## Compare PCA, t-SNE, and UMAP\n\n```{r}\n#| fig.width: 12\n#| fig.height: 12\n\nlibrary(patchwork)\np_pca + p_tsne + p_umap + plot_layout(ncol = 2)\n```\n\n## Exercise (parameters exploration)\n\nTry changing perplexity = 5, 50 in t-SNE. Try n_neighbors = 5, 30 in UMAP. Do you see different patterns? Why? Repeat the exercise with different random seed. Are t-SNE and UMAP sensitive to random initialization?\n\n**Example code**\n\n```{r}\n# t-SNE with perplexity = 10\nset.seed(42)\ntsne_5 <- Rtsne(x_scaled, dims = 2, perplexity = 5)\ndf_tsne5 <- data.frame(X = tsne_5$Y[,1], Y = tsne_5$Y[,2], Subtype = labels)\n\n# t-SNE with perplexity = 50\nset.seed(42)\ntsne_50 <- Rtsne(x_scaled, dims = 2, perplexity = 50)\ndf_tsne50 <- data.frame(X = tsne_50$Y[,1], Y = tsne_50$Y[,2], Subtype = labels)\n\nset.seed(42)\n# UMAP with n_neighbors = 5\numap_5 <- umap(x_scaled, config = modifyList(umap.defaults, list(n_neighbors = 5)))\ndf_umap5 <- data.frame(X = umap_5$layout[,1], Y = umap_5$layout[,2], Subtype = labels)\n\nset.seed(42)\n# UMAP with n_neighbors = 30\numap_30 <- umap(x_scaled, config = modifyList(umap.defaults, list(n_neighbors = 30)))\ndf_umap30 <- data.frame(X = umap_30$layout[,1], Y = umap_30$layout[,2], Subtype = labels)\n\n# Plot\nlibrary(patchwork)\np1 <- ggplot(df_tsne5, aes(X, Y, color = Subtype)) + geom_point() +\n  ggtitle(\"t-SNE (perplexity = 5)\") + theme_minimal()\n\np2 <- ggplot(df_tsne50, aes(X, Y, color = Subtype)) + geom_point() +\n  ggtitle(\"t-SNE (perplexity = 50)\") + theme_minimal()\n\np3 <- ggplot(df_umap5, aes(X, Y, color = Subtype)) + geom_point() +\n  ggtitle(\"UMAP (n_neighbors = 5)\") + theme_minimal()\n\np4 <- ggplot(df_umap30, aes(X, Y, color = Subtype)) + geom_point() +\n  ggtitle(\"UMAP (n_neighbors = 30)\") + theme_minimal()\n\np1 + p2 + p3 + p4\n\n# Comments: \n\n# The comparison across parameter settings highlights how both t-SNE and UMAP balance local versus global structure depending on configuration:\n# t-SNE (perplexity = 10):\n# Shows very tight, localized groupings. Clusters are more fragmented, suggesting a strong focus on very close neighbors.\n# t-SNE (perplexity = 50):\n# Produces more continuous global structure. Classes are generally separated, but the fine local detail is smoothed out.\n# UMAP (n_neighbors = 5):\n# Strong emphasis on local clusters, resulting in a scattered, detailed structure with visible subgrouping. This may help detect subtypes or sub-clusters.\n# UMAP (n_neighbors = 30):\n# Prioritizes global structure. The major subtypes (Basal, Her2, LumA) appear as smoother, larger clusters, giving a clearer big-picture overview.\n\n# Both t-SNE and UMAP are sensitive to the random seed because they rely on random initialization and stochastic optimization to construct the low-dimensional embedding. t-SNE is generally more sensitive because its cost function is non-convex and it places stronger emphasis on preserving local structure, making it more prone to variability in point arrangement across runs\n\n```\n\n## Exercise (features variability)\n\nInvestigate which miRNA features vary the most across the dataset. Features with high variance are more likely to influence clustering in dimensionality reduction. Identify top variable features in orginal (unscaled) data and visualize sample distribution colored by expression of top feature on the selected t-SNE and UMAP plots.\n\n**Example code**\n\n```{r}\nlibrary(viridis)\n\n# Compute variance for each feature (column-wise)\nfeature_variance <- apply(x, 2, var)\ntop_features <- sort(feature_variance, decreasing = TRUE)[1:5]\nprint(top_features)\n\n# Visualize first top feature\ntop_feature <- names(top_features)[1]\n\n# t-SNE (perplexity = 5)\ntsne_5 <- Rtsne(x_scaled, dims = 2, perplexity = 5)\ndf_tsne5 <- data.frame(X = tsne_5$Y[,1], Y = tsne_5$Y[,2], Subtype = labels, TopFeature =  x[, top_feature])\n\n# UMAP (n_neighbors = 5)\numap_5 <- umap(x_scaled, config = modifyList(umap.defaults, list(n_neighbors = 5)))\ndf_umap5 <- data.frame(X = umap_5$layout[,1], Y = umap_5$layout[,2], Subtype = labels, TopFeature =  x[, top_feature])\n\np1 <- ggplot(df_tsne5, aes(x = X, y = Y, color = TopFeature, size = TopFeature)) +\n  geom_point() +\n  scale_color_viridis_c(option = \"C\") +\n  theme_minimal() +\n  labs(title = paste(\"t-SNE colored by expression of\", top_feature),\n       color = top_feature)\n\np2 <- ggplot(df_umap5, aes(x = X, y = Y, color = TopFeature, size = TopFeature)) +\n  geom_point() +\n  scale_color_viridis_c(option = \"C\") +\n  theme_minimal() +\n  labs(title = paste(\"UMAP colored by expression of\", top_feature),\n       color = top_feature)\n\np1 + p2\n\n```\n\n## Additional resources\n\n-   [How to use t-SNE effectively](https://distill.pub/2016/misread-tsne/)\n-   [Understanding UMAP](https://pair-code.github.io/understanding-umap/)\n","srcMarkdownNoYaml":"\n\n## Introduction\n\nIn this tutorial, we explore two popular nonlinear methods: **t-SNE** (t-distributed Stochastic Neighbor Embedding) and **UMAP** (Uniform Manifold Approximation and Projection).\n\n## t-SNE\n\n**t-SNE** works by computing pairwise similarities between points in high-dimensional space, then finding a low-dimensional embedding that preserves those similarities. It minimizes the divergence between probability distributions using gradient descent. It is particularly good at keeping similar points close together.\n\n**Steps in t-SNE**\n\n1.  Compute pairwise distances between all data points in high-dimensional space.\n2.  Convert distances to conditional probabilities representing similarities.\n3.  Initialize points randomly in 2D or 3D space.\n4.  Compute low-dimensional similarities using a t-distribution.\n5.  Minimize the Kullback-Leibler divergence between the two distributions using gradient descent.\n6.  Update points iteratively to reduce divergence.\n\n## UMAP\n\nUMAP constructs a high-dimensional graph representing the data and then optimizes a low-dimensional projection that preserves both local neighborhoods and some global relationships. It is built on manifold learning and is generally faster than t-SNE, scaling better to large datasets.\n\n**Steps in UMAP**\n\n1.  Compute k-nearest neighbors for each data point.\n2.  Estimate the probability graph based on local distances.\n3.  Construct a fuzzy topological representation of the data.\n4.  Initialize low-dimensional embedding randomly.\n5.  Optimize layout to preserve high-dimensional graph structure in low dimensions using stochastic gradient descent.\n\n## Data\n\n```{r}\nlibrary(tidyverse)\nlibrary(mixOmics)\ndata(breast.TCGA)\n\n# Combine training and test sets\nx <- rbind(breast.TCGA$data.train$mirna, breast.TCGA$data.test$mirna)\nlabels <- factor(c(breast.TCGA$data.train$subtype, breast.TCGA$data.test$subtype))\n\n# Scale the data\nx_scaled <- scale(x)\n```\n\n```{r}\n#| label: load-data\n\nlibrary(mixOmics)\ndata(breast.TCGA)\n\nx <- rbind(breast.TCGA$data.train$mirna,breast.TCGA$data.test$mirna)\ngroup_labels <-c(breast.TCGA$data.train$subtype,breast.TCGA$data.test$subtype)\n\n```\n\n```{r}\n#| label: fig-data-preview\n#| fig.cap: \"Preview of the miRNA data matrix\"\n#| fig.width: 12\n#| fig.height: 10\n\n# data dimensions\nx |> dim() |> print () # dimensions of the data matrix (samples x features)\ngroup_labels |> as.factor() |> summary() # samples per group\n\n# box plots \npar(mfrow=c(2,1))\nboxplot(t(x), main=\"distribution per sample\", las=2, cex.axis=0.7, col=rainbow(10), outline=FALSE, cex.main=0.8)\nboxplot(x, main=\"distribution per miRNA\", las=2, cex.axis=0.7, col=rainbow(10), outline=FALSE, cex.main=0.8)\n\n```\n\n```{r}\n#| label: pca\n#| fig.keep: all\n\n# perform PCA\npca <- prcomp(x, center=TRUE, scale.=FALSE)\neigs <- pca$sdev^2\nvar_exp <- eigs / sum(eigs)\n\nres_pca <- data.frame(PC1=pca$x[,1], PC2=pca$x[,2], PC3=pca$x[,3], PC4=pca$x[,4], PC5=pca$x[,5]) |>\n    rownames_to_column(\"sample\") |> \n    as_tibble() \n\nres_pca_loadings <- pca$rotation\n\n# show PCA scores plots\np_pca <- res_pca |>\n    ggplot(aes(x=PC1, y=PC2, color=group_labels)) +\n    geom_point() +\n    labs(title=\"PCA of miRNA data\", x=\"PC1\", y=\"PC2\") +\n    xlab(paste(\"PC1 (Var: \", round(var_exp[1] * 100, 2), \"%)\")) +\n    ylab(paste(\"PC2 (Var: \", round(var_exp[2] * 100, 2), \"%)\")) +\n    theme_minimal() +\n    scale_color_manual(values=c(\"Basal\"=\"#FF0000\", \"Her2\"=\"#00FF00\", \"LumA\"=\"#0000FF\")) +\n    theme(legend.title=element_blank())\n\n# show top 10 loadings along PC1\nres_pca_loadings |> \n    as.data.frame() |> \n    rownames_to_column(\"miRNA\") |> \n    arrange(desc(abs(PC1))) |> \n    head(10) |> \n    ggplot(aes(x=reorder(miRNA, PC1), y=PC1)) +\n    geom_bar(stat=\"identity\", fill=\"steelblue\") +\n    coord_flip() +\n    labs(title=\"Top 10 miRNAs contributing to PC1\", x=\"miRNA\", y=\"Loading\") +\n    theme_minimal()\n\n```\n\n## Run t-SNE\n\n```{r}\nlibrary(Rtsne)\n\nx_scaled <- scale(x) # scale data\n\nset.seed(42)\ntsne_out <- Rtsne(x_scaled, dims = 2, perplexity = 30, verbose = TRUE)\n\n# Key parameters\n# - perplexity: Balances local/global structure (recommended: 5–50)\n# - dims: Output dimensions (2D or 3D)\n# - theta: Speed/accuracy tradeoff\n# - max_iter: Iteration count\n\ntsne_df <- data.frame(\n  X = tsne_out$Y[, 1],\n  Y = tsne_out$Y[, 2],\n  Subtype = labels\n)\n\np_tsne <- ggplot(tsne_df, aes(x = X, y = Y, color = Subtype)) +\n  geom_point(size = 2) +\n  theme_minimal() +\n  labs(title = \"t-SNE on miRNA data\") + \n  scale_color_manual(values = c(\"Basal\" = \"#FF0000\", \"Her2\" = \"#00FF00\", \"LumA\" = \"#0000FF\"))\n\nplot(p_tsne)\n\n```\n\n## Run UMAP\n\n```{r}\nlibrary(umap)\n\nset.seed(42)\numap_out <- umap(x_scaled)\n\n# Key parameters\n# - n_neighbors: Higher = more global structure\n# - min_dist: Smaller = tighter clusters\n# - metric: Distance measure (e.g., \"euclidean\")\n\numap_df <- data.frame(\n  X = umap_out$layout[, 1],\n  Y = umap_out$layout[, 2],\n  Subtype = labels\n)\n\np_umap <- ggplot(umap_df, aes(x = X, y = Y, color = Subtype)) +\n  geom_point(size = 2) +\n  theme_minimal() +\n  labs(title = \"UMAP on miRNA data\") + \n  scale_color_manual(values = c(\"Basal\" = \"#FF0000\", \"Her2\" = \"#00FF00\", \"LumA\" = \"#0000FF\"))\n\nplot(p_umap)\n```\n\n## Compare PCA, t-SNE, and UMAP\n\n```{r}\n#| fig.width: 12\n#| fig.height: 12\n\nlibrary(patchwork)\np_pca + p_tsne + p_umap + plot_layout(ncol = 2)\n```\n\n## Exercise (parameters exploration)\n\nTry changing perplexity = 5, 50 in t-SNE. Try n_neighbors = 5, 30 in UMAP. Do you see different patterns? Why? Repeat the exercise with different random seed. Are t-SNE and UMAP sensitive to random initialization?\n\n**Example code**\n\n```{r}\n# t-SNE with perplexity = 10\nset.seed(42)\ntsne_5 <- Rtsne(x_scaled, dims = 2, perplexity = 5)\ndf_tsne5 <- data.frame(X = tsne_5$Y[,1], Y = tsne_5$Y[,2], Subtype = labels)\n\n# t-SNE with perplexity = 50\nset.seed(42)\ntsne_50 <- Rtsne(x_scaled, dims = 2, perplexity = 50)\ndf_tsne50 <- data.frame(X = tsne_50$Y[,1], Y = tsne_50$Y[,2], Subtype = labels)\n\nset.seed(42)\n# UMAP with n_neighbors = 5\numap_5 <- umap(x_scaled, config = modifyList(umap.defaults, list(n_neighbors = 5)))\ndf_umap5 <- data.frame(X = umap_5$layout[,1], Y = umap_5$layout[,2], Subtype = labels)\n\nset.seed(42)\n# UMAP with n_neighbors = 30\numap_30 <- umap(x_scaled, config = modifyList(umap.defaults, list(n_neighbors = 30)))\ndf_umap30 <- data.frame(X = umap_30$layout[,1], Y = umap_30$layout[,2], Subtype = labels)\n\n# Plot\nlibrary(patchwork)\np1 <- ggplot(df_tsne5, aes(X, Y, color = Subtype)) + geom_point() +\n  ggtitle(\"t-SNE (perplexity = 5)\") + theme_minimal()\n\np2 <- ggplot(df_tsne50, aes(X, Y, color = Subtype)) + geom_point() +\n  ggtitle(\"t-SNE (perplexity = 50)\") + theme_minimal()\n\np3 <- ggplot(df_umap5, aes(X, Y, color = Subtype)) + geom_point() +\n  ggtitle(\"UMAP (n_neighbors = 5)\") + theme_minimal()\n\np4 <- ggplot(df_umap30, aes(X, Y, color = Subtype)) + geom_point() +\n  ggtitle(\"UMAP (n_neighbors = 30)\") + theme_minimal()\n\np1 + p2 + p3 + p4\n\n# Comments: \n\n# The comparison across parameter settings highlights how both t-SNE and UMAP balance local versus global structure depending on configuration:\n# t-SNE (perplexity = 10):\n# Shows very tight, localized groupings. Clusters are more fragmented, suggesting a strong focus on very close neighbors.\n# t-SNE (perplexity = 50):\n# Produces more continuous global structure. Classes are generally separated, but the fine local detail is smoothed out.\n# UMAP (n_neighbors = 5):\n# Strong emphasis on local clusters, resulting in a scattered, detailed structure with visible subgrouping. This may help detect subtypes or sub-clusters.\n# UMAP (n_neighbors = 30):\n# Prioritizes global structure. The major subtypes (Basal, Her2, LumA) appear as smoother, larger clusters, giving a clearer big-picture overview.\n\n# Both t-SNE and UMAP are sensitive to the random seed because they rely on random initialization and stochastic optimization to construct the low-dimensional embedding. t-SNE is generally more sensitive because its cost function is non-convex and it places stronger emphasis on preserving local structure, making it more prone to variability in point arrangement across runs\n\n```\n\n## Exercise (features variability)\n\nInvestigate which miRNA features vary the most across the dataset. Features with high variance are more likely to influence clustering in dimensionality reduction. Identify top variable features in orginal (unscaled) data and visualize sample distribution colored by expression of top feature on the selected t-SNE and UMAP plots.\n\n**Example code**\n\n```{r}\nlibrary(viridis)\n\n# Compute variance for each feature (column-wise)\nfeature_variance <- apply(x, 2, var)\ntop_features <- sort(feature_variance, decreasing = TRUE)[1:5]\nprint(top_features)\n\n# Visualize first top feature\ntop_feature <- names(top_features)[1]\n\n# t-SNE (perplexity = 5)\ntsne_5 <- Rtsne(x_scaled, dims = 2, perplexity = 5)\ndf_tsne5 <- data.frame(X = tsne_5$Y[,1], Y = tsne_5$Y[,2], Subtype = labels, TopFeature =  x[, top_feature])\n\n# UMAP (n_neighbors = 5)\numap_5 <- umap(x_scaled, config = modifyList(umap.defaults, list(n_neighbors = 5)))\ndf_umap5 <- data.frame(X = umap_5$layout[,1], Y = umap_5$layout[,2], Subtype = labels, TopFeature =  x[, top_feature])\n\np1 <- ggplot(df_tsne5, aes(x = X, y = Y, color = TopFeature, size = TopFeature)) +\n  geom_point() +\n  scale_color_viridis_c(option = \"C\") +\n  theme_minimal() +\n  labs(title = paste(\"t-SNE colored by expression of\", top_feature),\n       color = top_feature)\n\np2 <- ggplot(df_umap5, aes(x = X, y = Y, color = TopFeature, size = TopFeature)) +\n  geom_point() +\n  scale_color_viridis_c(option = \"C\") +\n  theme_minimal() +\n  labs(title = paste(\"UMAP colored by expression of\", top_feature),\n       color = top_feature)\n\np1 + p2\n\n```\n\n## Additional resources\n\n-   [How to use t-SNE effectively](https://distill.pub/2016/misread-tsne/)\n-   [Understanding UMAP](https://pair-code.github.io/understanding-umap/)\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"output-file":"tSNE-UMAP.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.36","bibliography":["references.bib"],"theme":"spacebar","mermaid":{"theme":"forest"},"title":"t-SNE and UMAP","editor":"visual","editor_options":{"chunk_output_type":"console"},"knitr":{"opts_chunk":{"message":false,"warning":false,"code-fold":false,"include":true,"collapse":true,"eval":true,"fig.show":"hold"}},"toc-location":"right","sidebar":true},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}